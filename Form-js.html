<!--
  Direitos Autorais (c) 2023 Renata Veras Venturim

  Licença MIT

  A permissão é concedida, gratuitamente, a qualquer pessoa que obtenha uma cópia
  deste software e dos arquivos de documentação associados (o "Software"), para negociar
  no Software sem restrições, incluindo, sem limitação, os direitos de uso, cópia,
  modificação, fusão, publicação, distribuição, sublicenciamento e/ou venda de cópias do Software,
  e de permitir que as pessoas a quem o Software é fornecido o façam, sujeitas às seguintes condições:

  O aviso de direitos autorais acima e este aviso de permissão devem ser incluídos em todas as cópias
  ou partes substanciais do Software.

  **Atribution Clause:**
  Os usuários deste software são obrigados a manter os créditos originais e as atribuições do projeto
  em quaisquer cópias ou derivações do Software.

  O SOFTWARE É FORNECIDO "COMO ESTÁ", SEM GARANTIA DE QUALQUER TIPO, EXPRESSA OU IMPLÍCITA,
  INCLUINDO, MAS NÃO SE LIMITANDO ÀS GARANTIAS DE COMERCIALIZAÇÃO, ADEQUAÇÃO A UM PROPÓSITO ESPECÍFICO
  E NÃO VIOLAÇÃO. EM NENHUM CASO OS AUTORES OU DETENTORES DOS DIREITOS AUTORAIS SERÃO RESPONSÁVEIS
  POR QUALQUER REIVINDICAÇÃO, DANOS OU OUTRAS RESPONSABILIDADES, SEJA EM AÇÃO DE CONTRATO, DELITO
  OU DE OUTRA FORMA, DECORRENTES DE, OU EM CONEXÃO COM O SOFTWARE OU O USO OU OUTRAS NEGOCIAÇÕES NO PROGRAMAS.
-->

<script>

  function Mensagem(){
     
     this.Executar = function (){
  
     var Largura = window.innerWidth;
     var Altura = window.innerHeigth;
     
     var Objetos = document.getElementById("Componentes");
     var Caixa = document.getElementById("CaixaMensagem");
     
     Objetos.style.display = "block";
     Objetos.style.heigth = Altura+ "px";
     
     Caixa.style.left = (Largura/2) - (550 * .5)+"px";
     Caixa.style.top = "70px";
     Caixa.style.display = "block";
     
      document.getElementById("TituloMsg").innerHTML = "AVISO";
      document.getElementById("CorpoMsg").innerHTML = "DESEJA REALMENTE EXCLUIR?";
      document.getElementById("RodapeMsg").innerHTML = '<button class = "green" onclick= "Confirm.Sim()"> <b> <font color= "black" size = "5">Sim</font></b></button><button class = "red" onclick= "Confirm.Nao()"> <b><font color= "black"  size = "5">Não</font></b></button>';                                                                                                               
         
     }
     
     this.Nao = function (){   
     Fechar();   
     }
     
     
     this.Sim = function (){
     
      document.getElementById("RodapeMsg").innerHTML = '<button onclick= "Fechar()"> <b> <font color= "black" size = "5">Fechar</font></b></button>';
      
     var criteriopesquisa = document.getElementById("Campo1").value;
     
     if (criteriopesquisa.trim().length ==0){ 
      document.getElementById("CorpoMsg").innerHTML = "Campo vazio. Preencha o nº do empenho";
     
      }else{
           
         google.script.run.withSuccessHandler(Carregar).ExcluirDados(criteriopesquisa);
    
          function Carregar(retorno){  
     
            if (retorno != "Não encontrado!"){
  
                document.getElementById("CorpoMsg").innerHTML = "EXCLUÍDO COM SUCESSO!";
  
             /* Limpar();*/
  
             }else{ 
  
                document.getElementById("CorpoMsg").innerHTML = " EMPENHO NÃO ENCONTRADO! Isto ocorre quando o empenho não existe, ou o ateste (confirmação de recebimento) por parte do curso ainda não foi realizado. Caso tenha sido fornecido o material ou serviço, solicitamos que envie a nota fiscal e o comprovante de entrega/prestação de serviço realizado para: compras.proppi@id.uff.br";
  
              }    
         }
     
       }
      }
     
     }   
     
  var Confirm = new Mensagem();
  
  function caixaMsgbox(m){
  
     var Largura = window.innerWidth;
     var Altura = window.innerHeigth;
     
     var Objetos = document.getElementById("Componentes");
     var Caixa = document.getElementById("CaixaMensagem");
     
     Objetos.style.display = "block";
     Objetos.style.heigth = Altura+ "px";
     
     Caixa.style.left = (Largura/2) - (550 * .5)+"px";
     Caixa.style.top = "70px";
     Caixa.style.display = "block";        
  
    document.getElementById("TituloMsg").innerHTML = "AVISO"; 
    document.getElementById("CorpoMsg").innerHTML = m;
    document.getElementById("RodapeMsg").innerHTML = '<button class = "orange" onclick= " Fechar()"> <b> <font color= "black" size = "5">Fechar</font></b></button>';
  
  }
  
  function Fechar(){
  document.getElementById("CaixaMensagem").style.display = "none";
  document.getElementById("Componentes").style.display = "none";
  }
  
  
  document.getElementById("btnpesquisar").addEventListener("click", Pesquisar);
   
    function Pesquisar(){  
    
    var criteriopesquisa = document.getElementById("Campo1").value;
    
    if (criteriopesquisa.trim().length == 0){  
     var m = "Campo vazio. Preencha o nº do empenho";
     caixaMsgbox(m);
     return false;
    };  
    
    google.script.run.withSuccessHandler(Carregar).PesquisarDados(criteriopesquisa);

}
    
    function Carregar(resultados) {
  var campoResultado = document.getElementById("Campo2");
  campoResultado.value = ""; // Limpa o campo de resultado

  if (resultados.length > 0 && resultados[0] !== "Não encontrado!") {
    for (var i = 0; i < resultados.length; i++) {
      campoResultado.value += "NOTA FISCAL:" + resultados[i].Campo3 +"\nEMPENHO:" + resultados[i].Campo1 + "\nPROCESSO:" + resultados[i].Campo2 + "\nSTATUS:" + resultados[i].Campo4 + "-"+resultados[i].Campo8+ "\nORDEM BANCÁRIA:" + resultados[i].Campo5 + "\nDATA DO PAGAMENTO:" + resultados[i].Campo6 + "\nOBSERVAÇÕES:" + resultados[i].Campo7 +"\n\n";
    }
    M.updateTextFields();
  } else {
    campoResultado.value = "EMPENHO NÃO ENCONTRADO! Isto ocorre quando o empenho não existe, ou o ateste (confirmação de recebimento) por parte do curso ainda não foi realizado. Caso tenha sido fornecido o material ou serviço, solicitamos que envie a nota fiscal e o comprovante de entrega/prestação de serviço realizado para: compras.proppi@id.uff.br";
  }
}

    
    
    
  </script>
